# S2. Контест: статистика пользователей (SQL, 15 баллов)

- ограничение по времени на тест: *15 секунд*
- ограничение по памяти на тест: *1024 мегабайта*
- ввод: *стандартный ввод*
- вывод: *стандартный вывод*
***
Это необычная задача — вам надо написать **SQL**-запрос. В качестве решения вы должны отослать один запрос к базе данных, который возвращает требуемые данные. Запрос может содержать произвольное количество подзапросов, других конструкций, быть сколь угодно навороченным, но это должен быть один запрос (в нём не должна встречаться точка с запятой для разделения разных запросов).

При проверке вашего решения используется **PostgreSQL 15.1**. В качестве входных данных вам предоставляется дамп состояния базы данных. Обратите внимание, что время работы вашего решения на тесте включает восстановление состояния базы данных из дампа, но это время значительно меньше ограничения по времени. Вы можете использовать сервис [sqlfiddle](http://sqlfiddle.com/) как инструмент для запуска запросов.

В этой задаче вам предстоит написать запрос к базе данных простейшей системы проведения соревнований по программированию. Вы прямо сейчас участвуете в подобном соревновании. Время почувствовать себя в роли разработчика системы для проведения таких соревнований!

Напишите запрос к базе данных, который возвращает всех пользователей вместе с некоторой дополнительной информацией:

- количеством соревнований, в которых он принял участие и решил там хотя бы одну задачу, соответствующую колонку в выводе следует назвать *solved_at_least_one_contest_count*,
- количеством соревнований, в которых он принял участие (то есть сделал хотя бы одну попытку решения), соответствующую колонку в выводе следует назвать *take_part_contest_count*.

Строки в выводе сортируйте в первую очередь по невозрастанию *solved_at_least_one_contest_count*, затем по невозрастанию *take_part_contest_count*, затем по возрастанию *id*.

Внимательно ознакомьтесь с примерами вывода. Ваш запрос должен иметь в точности такой же вывод на примерах.

Схема базы данных содержит четыре таблицы:

- **users** — пользователи системы (описываются двумя полями: *id* и *name*),
- **contests** — контесты в системе (описываются двумя полями: *id* и *name*),
- **problems** — задачи в системе, каждая задача принадлежит одному контесту (описываются тремя полями: *id*, *contest_id* и *code*, где *code* — это кодовое короткое название задачи),
- **submissions** — отосланные попытки решения задач, каждая попытка принадлежит одной задаче и одному пользователю (описываются 5 полями: *id*, *user_id*, *problem_id*, *success* и *submitted_at*, где *success* — это булевское значение была ли попытка успешной и *submitted_at* — дата-время, когда попытка была совершена).

Таким образом, **contests** и **problems** находятся в отношении «один ко многим», **submissions** и **users** находятся в отношении «многие к одному», **submissions** и **problems** находятся в отношении «многие к одному».

Изучите входные данные примера, чтобы подробно ознакомиться со схемой базы данных. Диаграмма ниже иллюстрирует схему базы данных.

### Входные данные
Входными данными в этой задаче является дамп базы данных. Вам он может быть полезен для ознакомления с состоянием базы данных для конкретного теста. В качестве решения вы должны отправить один **SQL**-запрос.

### Выходные данные
Ваш **SQL**-запрос должен вывести всех пользователей вместе с дополнительными колонками, как написано выше. В точности следуйте требованиям к именованию дополнительных колонок и порядку сортировки.

Внимательно ознакомьтесь с примерами вывода. Ваш запрос должен иметь в точности такой же вывод на примерах.

